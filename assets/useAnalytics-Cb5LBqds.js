import{r}from"./index-CVf8TyFT.js";class u{constructor(){this.isEnabled=typeof window<"u"&&window.umami,this.sessionId=this.generateSessionId(),this.sessionStartTime=Date.now(),this.sessionActions=[],this.contentScores=new Map,this.userStages=new Map}generateSessionId(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)}track(e,t={}){if(!this.isEnabled){console.log("ðŸ“Š Analytics (dev):",e,t);return}this.sessionActions.push(e);try{window.umami.track(e,{...t,session_id:this.sessionId})}catch(i){console.error("Analytics error:",i)}}getScoreTier(e){return e>=80?"excellent":e>=70?"good":e>=50?"medium":e>=30?"low":"very_low"}calculateEngagementScore(){const e=this.sessionActions||[],t=Date.now()-this.sessionStartTime;let i=0;e.includes("quiz_completed")&&(i+=50);const s=Math.min(t/3e4,20);i+=s;const o=e.filter(l=>l.includes("_viewed")).length;i+=o*5;const a=e.filter(l=>l==="cta_clicked").length;i+=a*10;const c=e.filter(l=>l==="faq_expanded").length;return i+=c*3,Math.min(i,100)}trackAttribution(e,t,i){this.track("attribution_detected",{source:e,medium:t,campaign:i,landing_page:window.location.pathname,referrer:document.referrer||"direct"})}trackConversionVelocity(e,t){const i=Date.now(),s=this.userStages.get(e);let o=0;if(s){const a=i-s.timestamp;o=Math.max(0,1-a/3e5)}this.userStages.set(e,{stage:t,timestamp:i}),this.track("conversion_velocity",{user_id:e,stage:t,velocity_score:Math.round(o*100)/100,time_since_previous:s?i-s.timestamp:0,conversion_likely:o>.7})}trackContentEffectiveness(e,t,i){const s=this.contentScores.get(e)||{views:0,interactions:0,totalTime:0};t==="viewed"?(s.views+=1,s.totalTime+=i||0):(t==="clicked"||t==="shared")&&(s.interactions+=1),this.contentScores.set(e,s);const o=this.calculateContentScore(e);this.track("content_effectiveness",{content_id:e,action:t,value:i,effectiveness_score:o,total_views:s.views,total_interactions:s.interactions})}calculateContentScore(e){const t=this.contentScores.get(e);if(!t||t.views===0)return 0;const i=t.interactions/t.views,s=t.totalTime/t.views,o=Math.min(i*100,50),a=Math.min(s/1e3,50);return Math.round(o+a)}quizStarted(e){this.track("quiz_started",{user_type:e})}quizStepCompleted(e,t,i,s,o){this.track("quiz_step_completed",{step:e,user_type:t,path:`${t}_path`,question_id:s,question_text:o?o.substring(0,100):"",answer:typeof i=="string"?i.substring(0,50):i,step_identifier:`${t}_step_${e}`})}quizAbandoned(e,t,i){this.track("quiz_abandoned",{step:e,user_type:t,path:`${t}_path`,question_id:i,step_identifier:`${t}_step_${e}`,completion_rate:Math.round(e/8*100),abandon_point:`${t}_step_${e}`})}quizCompleted(e,t,i){this.track("quiz_completed",{user_type:e,score:t,roi_estimate:i,lead_quality:t>70?"hot":t>40?"warm":"cold"})}quizModalOpened(e,t,i){this.track("quiz_modal_opened",{modal_type:e,user_type:t,score:i,score_tier:this.getScoreTier(i)})}quizModalClosed(e,t,i,s){this.track("quiz_modal_closed",{modal_type:e,user_type:t,time_spent_ms:i,close_action:s,engagement:i>3e4?"high":i>1e4?"medium":"low"})}reportDetailsViewed(e,t,i){this.track("report_details_viewed",{user_type:e,score:t,section:i,score_tier:this.getScoreTier(t)})}shareModalOpened(e,t,i){this.track("share_modal_opened",{user_type:e,score:t,share_type:i,score_tier:this.getScoreTier(t)})}teamShareStarted(e,t,i){this.track("team_share_started",{user_type:e,score:t,email_count:i,viral_potential:i>3?"high":"medium"})}teamShareCompleted(e,t,i,s){this.track("team_share_completed",{user_type:e,score:t,email_count:i,share_successful:s,viral_impact:s?"positive":"failed"})}leadModalOpened(e,t,i){this.track("lead_modal_opened",{trigger:e,user_type:t,score:i})}leadCaptured(e,t,i,s){this.track("lead_captured",{user_type:e,score:t,has_company:i,has_phone:s,lead_quality:t>70?"hot":t>40?"warm":"cold"})}leadCaptureFailed(e,t){this.track("lead_capture_failed",{error_type:e,user_type:t})}pdfDownloadEligible(e,t,i){this.track("pdf_download_eligible",{user_type:e,score:t,eligible:i,score_tier:this.getScoreTier(t),eligibility_reason:i?"score_sufficient":"score_too_low"})}pdfDownloadStarted(e,t,i){this.track("pdf_download_started",{user_type:e,score:t,download_type:i,score_tier:this.getScoreTier(t)})}pdfDownloadCompleted(e,t,i){this.track("pdf_download_completed",{user_type:e,score:t,download_time_ms:i,download_successful:!0,conversion_quality:"high"})}pdfDownloadFailed(e,t,i,s){this.track("pdf_download_failed",{user_type:e,score:t,error_type:i,error_message:s.substring(0,100),download_successful:!1})}reportButtonClicked(e,t,i){this.track("report_button_clicked",{user_type:e,score:t,location:i})}shareButtonClicked(e,t,i){this.track("share_button_clicked",{user_type:e,score:t,method:i})}headerNavClicked(e,t,i){this.track("header_nav_clicked",{link_text:e.substring(0,30),destination:t,section:i})}ctaClicked(e,t,i,s){this.track("cta_clicked",{location:e,text:t.substring(0,30),type:i,cta_id:s||"unknown",scroll_position:Math.round(window.scrollY/100)*100})}carouselInteraction(e,t,i,s){this.track("carousel_interaction",{carousel_type:e,method:t,slide_index:i,item_id:s,device:window.innerWidth<768?"mobile":"desktop"})}caseStudyViewed(e,t,i){this.track("case_study_viewed",{case_id:e,title:t.substring(0,50),view_time_ms:i,engagement:i>1e4?"high":i>5e3?"medium":"low"})}caseStudyInteraction(e,t,i){this.track("case_study_interaction",{case_id:e,interaction_type:t,element:i})}testimonialViewed(e,t,i){this.track("testimonial_viewed",{testimonial_id:e,name:t,view_time_ms:i,engagement:i>8e3?"high":i>3e3?"medium":"low"})}faqExpanded(e,t,i){this.track("faq_expanded",{question_id:e,question_text:t.substring(0,50),section:i||"main_faq",user_intent:"information_seeking"})}faqCollapsed(e,t){this.track("faq_collapsed",{question_id:e,time_spent_ms:t,engagement:t>5e3?"high":t>2e3?"medium":"low"})}infoBoxOpened(e,t,i){this.track("info_box_opened",{box_type:e,box_id:t,trigger:i})}infoBoxLinkClicked(e,t,i){this.track("info_box_link_clicked",{box_id:e,link_text:t.substring(0,30),destination:i})}errorOccurred(e,t,i){this.track("error_occurred",{error_type:e,message:t.substring(0,100),component:i,critical:["network","api","component"].includes(e)})}performanceMetrics(e,t,i){this.track("performance_metrics",{lcp:Math.round(e),fid:Math.round(t),cls:Math.round(i*1e3)/1e3,device:window.innerWidth<768?"mobile":"desktop"})}scrollMilestone(e){this.track("scroll_milestone",{percentage:e,engagement:e>75?"high":e>50?"medium":"low"})}}const d=new u;function m(n,e,t){const i=r.useRef(null),s=r.useRef(!1),o=r.useCallback(()=>{s.current||(i.current=Date.now(),s.current=!0)},[]),a=r.useCallback(()=>{if(i.current&&s.current){const c=Date.now()-i.current;d.caseStudyViewed(e,t,c),i.current=null,s.current=!1}},[n,e,t]);return{startViewTracking:o,endViewTracking:a}}function p(n){const e=r.useRef(null),t=r.useCallback(()=>{e.current=Date.now(),d.quizStarted(n)},[n]),i=r.useCallback((a,c,l,_)=>{d.quizStepCompleted(a,n,c,l,_)},[n]),s=r.useCallback((a,c)=>{d.quizAbandoned(a,n,c)},[n]),o=r.useCallback((a,c)=>{d.quizCompleted(n,a,c)},[n]);return{startQuiz:t,completeStep:i,abandonQuiz:s,completeQuiz:o}}function k(n){return{trackInteraction:r.useCallback((t,i,s)=>{d.carouselInteraction(n,t,i,s)},[n])}}function f(){const n=r.useCallback((i,s,o)=>{d.leadModalOpened(i,s,o)},[]),e=r.useCallback((i,s,o)=>{d.leadCaptured(i,s,!!o.company,!!o.phone)},[]),t=r.useCallback((i,s)=>{d.leadCaptureFailed(i,s)},[]);return{trackOpen:n,trackLeadCapture:e,trackError:t}}export{d as a,p as b,m as c,k as d,f as u};
