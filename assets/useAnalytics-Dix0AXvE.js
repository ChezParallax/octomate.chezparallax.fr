import{r as n}from"./index-CVf8TyFT.js";class u{constructor(){this.isEnabled=typeof window<"u"&&window.umami,this.sessionId=this.generateSessionId(),this.sessionStartTime=Date.now(),this.sessionActions=[],this.contentScores=new Map,this.userStages=new Map}generateSessionId(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)}track(e,i={}){if(!this.isEnabled){console.log("ðŸ“Š Analytics (dev):",e,i);return}this.sessionActions.push(e);try{window.umami.track(e,{...i,session_id:this.sessionId})}catch(t){console.error("Analytics error:",t)}}getScoreTier(e){return e>=80?"excellent":e>=70?"good":e>=50?"medium":e>=30?"low":"very_low"}calculateEngagementScore(){const e=this.sessionActions||[],i=Date.now()-this.sessionStartTime;let t=0;e.includes("quiz_completed")&&(t+=50);const s=Math.min(i/3e4,20);t+=s;const o=e.filter(l=>l.includes("_viewed")).length;t+=o*5;const r=e.filter(l=>l==="cta_clicked").length;t+=r*10;const d=e.filter(l=>l==="faq_expanded").length;return t+=d*3,Math.min(t,100)}trackAttribution(e,i,t){this.track("attribution_detected",{source:e,medium:i,campaign:t,landing_page:window.location.pathname,referrer:document.referrer||"direct"})}trackConversionVelocity(e,i){const t=Date.now(),s=this.userStages.get(e);let o=0;if(s){const r=t-s.timestamp;o=Math.max(0,1-r/3e5)}this.userStages.set(e,{stage:i,timestamp:t}),this.track("conversion_velocity",{user_id:e,stage:i,velocity_score:Math.round(o*100)/100,time_since_previous:s?t-s.timestamp:0,conversion_likely:o>.7})}quizStarted(e){this.track("quiz_started",{user_type:e})}quizStepCompleted(e,i,t,s,o){this.track("quiz_step_completed",{step:e,user_type:i,path:`${i}_path`,question_id:s,question_text:o?o.substring(0,100):"",answer:typeof t=="string"?t.substring(0,50):t,step_identifier:`${i}_step_${e}`})}quizAbandoned(e,i,t){this.track("quiz_abandoned",{step:e,user_type:i,path:`${i}_path`,question_id:t,step_identifier:`${i}_step_${e}`,completion_rate:Math.round(e/8*100),abandon_point:`${i}_step_${e}`})}quizCompleted(e,i,t){this.track("quiz_completed",{user_type:e,score:i,roi_estimate:t,lead_quality:i>70?"hot":i>40?"warm":"cold"})}quizModalOpened(e,i,t){this.track("quiz_modal_opened",{modal_type:e,user_type:i,score:t,score_tier:this.getScoreTier(t)})}quizModalClosed(e,i,t,s){this.track("quiz_modal_closed",{modal_type:e,user_type:i,time_spent_ms:t,close_action:s,engagement:t>3e4?"high":t>1e4?"medium":"low"})}reportDetailsViewed(e,i,t){this.track("report_details_viewed",{user_type:e,score:i,section:t,score_tier:this.getScoreTier(i)})}shareModalOpened(e,i,t){this.track("share_modal_opened",{user_type:e,score:i,share_type:t,score_tier:this.getScoreTier(i)})}teamShareStarted(e,i,t){this.track("team_share_started",{user_type:e,score:i,email_count:t,viral_potential:t>3?"high":"medium"})}teamShareCompleted(e,i,t,s){this.track("team_share_completed",{user_type:e,score:i,email_count:t,share_successful:s,viral_impact:s?"positive":"failed"})}leadModalOpened(e,i,t){this.track("lead_modal_opened",{trigger:e,user_type:i,score:t})}leadCaptured(e,i,t,s){this.track("lead_captured",{user_type:e,score:i,has_company:t,has_phone:s,lead_quality:i>70?"hot":i>40?"warm":"cold"})}leadCaptureFailed(e,i){this.track("lead_capture_failed",{error_type:e,user_type:i})}pdfDownloadEligible(e,i,t){this.track("pdf_download_eligible",{user_type:e,score:i,eligible:t,score_tier:this.getScoreTier(i),eligibility_reason:t?"score_sufficient":"score_too_low"})}pdfDownloadStarted(e,i,t){this.track("pdf_download_started",{user_type:e,score:i,download_type:t,score_tier:this.getScoreTier(i)})}pdfDownloadCompleted(e,i,t){this.track("pdf_download_completed",{user_type:e,score:i,download_time_ms:t,download_successful:!0,conversion_quality:"high"})}pdfDownloadFailed(e,i,t,s){this.track("pdf_download_failed",{user_type:e,score:i,error_type:t,error_message:s.substring(0,100),download_successful:!1})}reportButtonClicked(e,i,t){this.track("report_button_clicked",{user_type:e,score:i,location:t})}shareButtonClicked(e,i,t){this.track("share_button_clicked",{user_type:e,score:i,method:t})}headerNavClicked(e,i,t){this.track("header_nav_clicked",{link_text:e.substring(0,30),destination:i,section:t})}ctaClicked(e,i,t,s){this.track("cta_clicked",{location:e,text:i.substring(0,30),type:t,cta_id:s||"unknown",scroll_position:Math.round(window.scrollY/100)*100})}carouselInteraction(e,i,t,s){this.track("carousel_interaction",{carousel_type:e,method:i,slide_index:t,item_id:s,device:window.innerWidth<768?"mobile":"desktop"})}caseStudyViewed(e,i,t){this.track("case_study_viewed",{case_id:e,title:i.substring(0,50),view_time_ms:t,engagement:t>1e4?"high":t>5e3?"medium":"low"})}caseStudyInteraction(e,i,t){this.track("case_study_interaction",{case_id:e,interaction_type:i,element:t})}testimonialViewed(e,i,t){this.track("testimonial_viewed",{testimonial_id:e,name:i,view_time_ms:t,engagement:t>8e3?"high":t>3e3?"medium":"low"})}faqExpanded(e,i,t){this.track("faq_expanded",{question_id:e,question_text:i.substring(0,50),section:t||"main_faq",user_intent:"information_seeking"})}faqCollapsed(e,i){this.track("faq_collapsed",{question_id:e,time_spent_ms:i,engagement:i>5e3?"high":i>2e3?"medium":"low"})}infoBoxOpened(e,i,t){this.track("info_box_opened",{box_type:e,box_id:i,trigger:t})}infoBoxLinkClicked(e,i,t){this.track("info_box_link_clicked",{box_id:e,link_text:i.substring(0,30),destination:t})}errorOccurred(e,i,t){this.track("error_occurred",{error_type:e,message:i.substring(0,100),component:t,critical:["network","api","component"].includes(e)})}performanceMetrics(e,i,t){this.track("performance_metrics",{lcp:Math.round(e),fid:Math.round(i),cls:Math.round(t*1e3)/1e3,device:window.innerWidth<768?"mobile":"desktop"})}scrollMilestone(e){this.track("scroll_milestone",{percentage:e,engagement:e>75?"high":e>50?"medium":"low"})}}const c=new u;function p(a){const e=n.useRef(null),i=n.useCallback(()=>{e.current=Date.now(),c.quizStarted(a)},[a]),t=n.useCallback((r,d,l,_)=>{c.quizStepCompleted(r,a,d,l,_)},[a]),s=n.useCallback((r,d)=>{c.quizAbandoned(r,a,d)},[a]),o=n.useCallback((r,d)=>{c.quizCompleted(a,r,d)},[a]);return{startQuiz:i,completeStep:t,abandonQuiz:s,completeQuiz:o}}function m(a){return{trackInteraction:n.useCallback((i,t,s)=>{c.carouselInteraction(a,i,t,s)},[a])}}function k(){const a=n.useCallback((t,s,o)=>{c.leadModalOpened(t,s,o)},[]),e=n.useCallback((t,s,o)=>{c.leadCaptured(t,s,!!o.company,!!o.phone)},[]),i=n.useCallback((t,s)=>{c.leadCaptureFailed(t,s)},[]);return{trackOpen:a,trackLeadCapture:e,trackError:i}}export{c as a,p as b,m as c,k as u};
