import{j as e}from"../assets/jsx-runtime-D5KAtRYC.js";import{r as n}from"../assets/index-CVf8TyFT.js";import{c as w}from"../assets/useAnalytics-Dix0AXvE.js";class k{constructor(t,o){this.element=t,this.onSwipe=o,this.startX=0,this.startY=0,this.threshold=50,this.restraint=100,this.allowedTime=300,this.startTime=0,this.bindEvents()}bindEvents(){this.element.addEventListener("touchstart",this.handleStart.bind(this),{passive:!0}),this.element.addEventListener("touchend",this.handleEnd.bind(this),{passive:!0})}handleStart(t){const o=t.touches[0];this.startX=o.clientX,this.startY=o.clientY,this.startTime=Date.now()}handleEnd(t){const o=t.changedTouches[0],r=o.clientX-this.startX,l=o.clientY-this.startY;Date.now()-this.startTime<=this.allowedTime&&Math.abs(r)>=this.threshold&&Math.abs(l)<=this.restraint&&this.onSwipe(r<0?"left":"right")}destroy(){this.element.removeEventListener("touchstart",this.handleStart),this.element.removeEventListener("touchend",this.handleEnd)}}function L(){const{trackInteraction:h}=w("testimonials"),[t,o]=n.useState([]),[r,l]=n.useState(0),[u,m]=n.useState(!0),[c,f]=n.useState(!1),p=n.useRef(null),g=n.useRef(null),x=n.useRef(new Set),d=n.useCallback((s,...a)=>{const i=`${s}_${a[0]}`;x.current.has(i)||(h(s,...a),x.current.add(i),setTimeout(()=>{x.current.delete(i)},5e3))},[h]);n.useEffect(()=>{const s=()=>f(window.innerWidth<768);return s(),window.addEventListener("resize",s,{passive:!0}),()=>window.removeEventListener("resize",s)},[]),n.useEffect(()=>{const s=[{id:"pierre-m",name:"Pierre M.",initials:"PM",company:"Gérant, Comkwatt Communication",avatar:{gradient:"from-copper to-copper/80",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_pierre-m.webp"},rating:5,quote:"Grâce à la solution qu'il nous a mise en place, nous avons pu récupérer automatiquement les numéros de téléphone ou adresses email pour près de 85 % de la base — un gain de temps colossal par rapport à un traitement manuel qui aurait pris des mois.",result:{text:"Système : Enrichissement automatique des données",theme:"green"}},{id:"patrick-b",name:"Patrick B.",initials:"PB",company:"Directeur, Rietmann France",avatar:{gradient:"from-light-blue to-light-blue/80",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_patrick-b.webp"},rating:5,quote:"Chaque mois, nous passions plusieurs heures à remettre en forme des tableaux de tarifs. Grâce à l'automatisation mise en place par Thibaud (un simple glissé-déposé !), nous avons gagné un temps considérable et supprimé totalement le risque d'erreur.",result:{text:"Système : Analyse et réorganisation des tableaux de tarifs",theme:"blue"}},{id:"sarah-l",name:"Sarah L.",initials:"SL",company:"Directrice Commerciale, Orphise",avatar:{gradient:"from-copper to-light-blue",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_sarah-l.webp"},rating:5,quote:"Ce système nous a libérés d'une tâche lourde et répétitive. Chaque commercial gagne plusieurs heures par semaine et surtout : ils se concentrent enfin sur ce qu'ils font le mieux, convaincre nos prospects.",result:{text:"Système : Séquences de relance",theme:"purple"}}];o(s),l(Math.floor(s.length/2)),m(!1);const a=document.getElementById("testimonials-skeleton");a&&(a.style.display="none");const i=document.querySelector(".testimonials-container");i&&i.setAttribute("data-testimonials-loaded","true")},[]);const v=n.useCallback(()=>{const s=(r+1)%t.length;l(s),d("arrow",s,t[s]?.id)},[r,t.length,t,d]),j=n.useCallback(()=>{const s=(r-1+t.length)%t.length;l(s),d("arrow",s,t[s]?.id)},[r,t.length,t,d]),b=n.useCallback(s=>{s!==r&&(l(s),d("click",s,t[s]?.id))},[r,t,d]);return n.useEffect(()=>{if(!c||!p.current)return;const s=a=>{const i=a==="left"?Math.min(r+1,t.length-1):Math.max(r-1,0);i!==r&&(l(i),d("swipe",i,t[i]?.id))};return g.current=new k(p.current,s),()=>{g.current?.destroy()}},[c,r,t.length,t,d]),u?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-copper"})}):t.length===0?e.jsx("div",{className:"text-center py-20 text-beige/60",children:"Aucun témoignage disponible"}):((()=>{const s=(r-1+t.length)%t.length,a=(r+1)%t.length;return[s,r,a]})(),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex justify-center mb-8 space-x-2",children:t.map((s,a)=>e.jsx("button",{onClick:()=>b(a),className:`w-3 h-3 rounded-full transition-all duration-300 ${a===r?"bg-copper scale-125":"bg-beige/30 hover:bg-copper/50"}`,"aria-label":`Aller au témoignage ${a+1}`},a))}),e.jsx("button",{onClick:j,className:"hidden md:flex absolute left-4 top-1/2 -translate-y-1/2 z-40 w-12 h-12 bg-copper/20 hover:bg-copper/30 rounded-full items-center justify-center text-copper hover:text-beige transition-all duration-300 backdrop-blur-lg border border-copper/20","aria-label":"Témoignage précédent",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:v,className:"hidden md:flex absolute right-4 top-1/2 -translate-y-1/2 z-40 w-12 h-12 bg-copper/20 hover:bg-copper/30 rounded-full items-center justify-center text-copper hover:text-beige transition-all duration-300 backdrop-blur-lg border border-copper/20","aria-label":"Témoignage suivant",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsxs("div",{className:"md:hidden flex justify-center items-center gap-2 mb-4 text-beige/60 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{children:"Balayez pour naviguer"}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"hidden md:block absolute left-0 top-0 bottom-0 w-24 bg-gradient-to-r from-dark-blue to-transparent z-30 pointer-events-none"}),e.jsx("div",{className:"hidden md:block absolute right-0 top-0 bottom-0 w-24 bg-gradient-to-l from-dark-blue to-transparent z-30 pointer-events-none"}),e.jsx("div",{className:`overflow-y-visible py-8 ${c?"overflow-x-hidden px-8":"overflow-x-hidden px-4"}`,style:{minHeight:c?"auto":void 0},children:e.jsx("div",{ref:p,className:`flex transition-transform duration-500 ease-out ${c?"":"justify-center"}`,style:{transform:c?`translateX(-${r*100}%)`:`translateX(${-(r-1)*320}px)`},children:t.map((s,a)=>{const i=a===r;return e.jsx("div",{className:`transition-all duration-500 ${c?"w-full flex-shrink-0 px-4":"flex-shrink-0 px-2 w-80 max-w-xs"} ${i||c?"scale-100 opacity-100":"scale-95 opacity-70"}`,onClick:()=>!i&&b(a),style:{cursor:i?"default":"pointer"},children:e.jsx(N,{testimonial:s,isActive:i})},s.id)})})})]})]}))}const y=n.memo(function({testimonial:t}){const[o,r]=n.useState(!1),[l,u]=n.useState(!1);return e.jsxs("div",{className:"relative w-16 h-16 mx-auto",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${t.avatar.gradient} rounded-full flex items-center justify-center ${t.avatar.textColor} font-bold text-xl transition-opacity duration-300 ${l&&!o?"opacity-0":"opacity-100"}`,children:t.initials}),!o&&e.jsx("img",{src:t.avatar.image,alt:`Photo de ${t.name}`,className:`absolute inset-0 w-full h-full object-cover rounded-full border-2 border-beige/20 transition-opacity duration-300 ${l?"opacity-100":"opacity-0"}`,onError:()=>r(!0),onLoad:()=>u(!0),loading:"lazy"}),l&&!o&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-dark-blue/10 rounded-full"})]})}),N=n.memo(function({testimonial:t,isActive:o}){const l=(u=>{const m={green:"text-green-400 bg-green-400",blue:"text-blue-400 bg-blue-400",purple:"text-purple-400 bg-purple-400",orange:"text-orange-400 bg-orange-400"};return m[u]||m.green})(t.result.theme);return e.jsxs("div",{className:"bg-gradient-to-br from-beige/5 via-beige/3 to-transparent backdrop-blur-lg border border-beige/15 rounded-2xl hover:border-beige/25 hover:shadow-lg hover:shadow-black/10 transition-all duration-300 ease-out relative overflow-hidden group p-6 md:min-h-[400px] flex flex-col",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700 ease-out z-10 pointer-events-none"}),e.jsxs("div",{className:"relative z-20 flex flex-col h-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(y,{testimonial:t})}),e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("div",{className:"flex text-yellow-400",children:[...Array(t.rating)].map((u,m)=>e.jsx("span",{children:"⭐"},m))}),e.jsxs("span",{className:"text-beige/60 text-sm",children:[t.rating,"/5"]})]})]}),e.jsxs("blockquote",{className:"text-beige/90 italic text-sm leading-relaxed flex-grow",children:['"',t.quote,'"']}),e.jsxs("div",{className:"border-t border-beige/10 pt-4 mt-6",children:[e.jsx("div",{className:"font-semibold text-copper text-lg",children:t.name}),e.jsx("div",{className:"text-sm text-beige/60 mb-3",children:t.company}),e.jsxs("div",{className:`text-sm mt-2 flex items-center justify-center gap-2 ${l.split(" ")[0]}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${l.split(" ")[1]}`}),e.jsx("span",{children:t.result.text})]})]})]})]})});export{L as default};
