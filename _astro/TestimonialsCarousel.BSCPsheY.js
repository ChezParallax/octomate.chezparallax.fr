import{j as t}from"../assets/jsx-runtime-D5KAtRYC.js";import{r as c}from"../assets/index-CVf8TyFT.js";import{d as L}from"../assets/useAnalytics-Cb5LBqds.js";class q{constructor(e,i={}){this.element=e,this.options={threshold:10,velocityThreshold:.3,momentumReduction:.95,snapThreshold:.4,maxVelocity:8,...i},this.state={isDragging:!1,startX:0,currentX:0,deltaX:0,velocity:0,lastMoveTime:0,animationFrame:null},this.callbacks={},this.bindEvents()}bindEvents(){this.element.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),this.element.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),this.element.addEventListener("touchend",this.handleTouchEnd.bind(this),{passive:!0}),this.element.addEventListener("touchcancel",this.handleTouchEnd.bind(this),{passive:!0})}handleTouchStart(e){if(e.touches.length!==1)return;const i=e.touches[0];this.state.startX=i.clientX,this.state.currentX=i.clientX,this.state.lastMoveTime=Date.now(),this.state.velocity=0,this.state.animationFrame&&(cancelAnimationFrame(this.state.animationFrame),this.state.animationFrame=null),this.callbacks.onStart?.(e,this.state)}handleTouchMove(e){if(e.touches.length!==1)return;const i=e.touches[0],a=Date.now(),o=a-this.state.lastMoveTime;if(this.state.currentX=i.clientX,this.state.deltaX=this.state.currentX-this.state.startX,o>0){const u=this.state.currentX-(this.state.startX+this.state.deltaX);this.state.velocity=u/o}!this.state.isDragging&&Math.abs(this.state.deltaX)>this.options.threshold&&(this.state.isDragging=!0,this.callbacks.onDragStart?.(e,this.state),e.preventDefault()),this.state.isDragging&&(e.preventDefault(),this.callbacks.onDrag?.(e,this.state)),this.state.lastMoveTime=a}handleTouchEnd(e){if(!this.state.isDragging){this.callbacks.onTap?.(e,this.state),this.resetState();return}Math.abs(this.state.velocity)>this.options.velocityThreshold?this.startMomentum():this.callbacks.onDragEnd?.(e,this.state),this.resetState()}startMomentum(){const{velocity:e}=this.state,i=e>0?1:-1;let a=Math.min(Math.abs(e),this.options.maxVelocity)*i;const o=()=>{if(Math.abs(a)<.01){this.callbacks.onMomentumEnd?.(this.state);return}this.state.deltaX+=a*16,this.callbacks.onMomentum?.(this.state),a*=this.options.momentumReduction,this.state.animationFrame=requestAnimationFrame(o)};o()}resetState(){this.state.isDragging=!1,this.state.startX=0,this.state.currentX=0,this.state.deltaX=0,this.state.velocity=0}on(e,i){return this.callbacks[e]=i,this}destroy(){this.state.animationFrame&&cancelAnimationFrame(this.state.animationFrame)}}function z(){const{trackInteraction:n}=L("testimonials"),[e,i]=c.useState([]),[a,o]=c.useState(0),[u,f]=c.useState(!0),[d,M]=c.useState(!1),[E,x]=c.useState(0),[T,v]=c.useState(!1),m=c.useRef(null),y=c.useRef(null);c.useEffect(()=>{const s=()=>{M(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),c.useEffect(()=>{const s=[{id:"pierre-m",name:"Pierre M.",initials:"PM",company:"Gérant, Comkwatt Communication",avatar:{gradient:"from-copper to-copper/80",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_pierre-m.webp"},rating:5,quote:"Grâce à la solution qu'il nous a mise en place, nous avons pu récupérer automatiquement les numéros de téléphone ou adresses email pour près de 85 % de la base — un gain de temps colossal par rapport à un traitement manuel qui aurait pris des mois.",result:{text:"Système : Enrichissement automatique des données",theme:"green"}},{id:"patrick-b",name:"Patrick B.",initials:"PB",company:"Directeur, Rietmann France",avatar:{gradient:"from-light-blue to-light-blue/80",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_patrick-b.webp"},rating:5,quote:"Chaque mois, nous passions plusieurs heures à remettre en forme des tableaux de tarifs. Grâce à l'automatisation mise en place par Thibaud (un simple glissé-déposé !), nous avons gagné un temps considérable et supprimé totalement le risque d'erreur.",result:{text:"Système : Analyse et réorganisation des tableaux de tarifs",theme:"blue"}},{id:"sarah-l",name:"Sarah L.",initials:"SL",company:"Directrice Commerciale, Orphise",avatar:{gradient:"from-copper to-light-blue",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_sarah-l.webp"},rating:5,quote:"Ce système nous a libérés d'une tâche lourde et répétitive. Chaque commercial gagne plusieurs heures par semaine et surtout : ils se concentrent enfin sur ce qu'ils font le mieux, convaincre nos prospects.",result:{text:"Système : Séquences de relance",theme:"purple"}}];i(s),o(Math.floor(s.length/2)),f(!1);const r=document.getElementById("testimonials-skeleton");r&&(r.style.display="none");const l=document.querySelector(".testimonials-container");l&&l.setAttribute("data-testimonials-loaded","true")},[]);const S=()=>{const s=(a+1)%e.length;n("arrow",s,e[s]?.id||`slide_${s}`),o(s)},X=()=>{const s=(a-1+e.length)%e.length;n("arrow",s,e[s]?.id||`slide_${s}`),o(s)},N=c.useCallback(s=>{if(n("click",s,e[s]?.id||`slide_${s}`),o(s),d){const r=m.current?.offsetWidth||0;x(-s*r),v(!0)}},[d,n,e]);c.useEffect(()=>{if(!d||!m.current||e.length===0)return;const s=m.current,l=s.offsetWidth;return y.current=new q(s,{threshold:15,velocityThreshold:.5,snapThreshold:.25,momentumReduction:.92}),y.current.on("onDragStart",()=>{v(!1),s.style.willChange="transform"}).on("onDrag",(b,p)=>{const g=-a*l+p.deltaX,j=0,k=-(e.length-1)*l;let w=g;g>j?w=j+(g-j)*.3:g<k&&(w=k+(g-k)*.3),x(w)}).on("onDragEnd",(b,p)=>{C(p,l)}).on("onMomentumEnd",b=>{C(b,l)}),()=>{y.current?.destroy(),s.style.willChange="auto"}},[d,e.length,a]);const C=c.useCallback((s,r)=>{const{deltaX:l}=s,p=(m.current?.offsetWidth||0)*.25;let h=a;Math.abs(l)>p&&(l>0&&a>0?h=a-1:l<0&&a<e.length-1&&(h=a+1)),h!==a&&n("swipe",h,e[h]?.id||`slide_${h}`),v(!0),o(h),x(-h*r),setTimeout(()=>{m.current&&(m.current.style.willChange="auto")},500)},[a,e.length,n,e]);return u?t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-copper"})}):e.length===0?t.jsx("div",{className:"text-center py-20 text-beige/60",children:"Aucun témoignage disponible"}):((()=>{const s=(a-1+e.length)%e.length,r=(a+1)%e.length;return[s,a,r]})(),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"flex justify-center mb-8 space-x-2",children:e.map((s,r)=>t.jsx("button",{onClick:()=>N(r),className:`w-3 h-3 rounded-full transition-all duration-300 ${r===a?"bg-copper scale-125":"bg-beige/30 hover:bg-copper/50"}`,"aria-label":`Aller au témoignage ${r+1}`},r))}),t.jsx("button",{onClick:X,className:"hidden md:flex absolute left-4 top-1/2 -translate-y-1/2 z-40 w-12 h-12 bg-copper/20 hover:bg-copper/30 rounded-full items-center justify-center text-copper hover:text-beige transition-all duration-300 backdrop-blur-lg border border-copper/20","aria-label":"Témoignage précédent",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("button",{onClick:S,className:"hidden md:flex absolute right-4 top-1/2 -translate-y-1/2 z-40 w-12 h-12 bg-copper/20 hover:bg-copper/30 rounded-full items-center justify-center text-copper hover:text-beige transition-all duration-300 backdrop-blur-lg border border-copper/20","aria-label":"Témoignage suivant",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),t.jsxs("div",{className:"md:hidden flex justify-center items-center gap-2 mb-4 text-beige/60 text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{children:"Balayez pour naviguer"}),t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"hidden md:block absolute left-0 top-0 bottom-0 w-24 bg-gradient-to-r from-dark-blue to-transparent z-30 pointer-events-none"}),t.jsx("div",{className:"hidden md:block absolute right-0 top-0 bottom-0 w-24 bg-gradient-to-l from-dark-blue to-transparent z-30 pointer-events-none"}),t.jsx("div",{className:`overflow-y-visible py-8 ${d?"overflow-x-hidden px-8":"overflow-x-hidden px-4"}`,children:t.jsx("div",{ref:m,className:`flex ${d&&T?"transition-transform duration-500 ease-out":d?"":"transition-transform duration-500 ease-out justify-center"}`,style:{transform:d?`translate3d(${E}px, 0, 0)`:`translateX(${-(a-1)*320}px)`,willChange:d&&!T?"transform":"auto"},children:e.map((s,r)=>{const l=r===a;return t.jsx("div",{className:`transition-all duration-500 ${d?"w-full flex-shrink-0 px-4":"flex-shrink-0 px-2 w-80 max-w-xs"} ${l||d?"scale-100 opacity-100":"scale-95 opacity-70"}`,onClick:()=>!l&&N(r),style:{cursor:l?"default":"pointer"},children:t.jsx(D,{testimonial:s,isActive:l})},s.id)})})})]})]}))}function $({testimonial:n}){const[e,i]=c.useState(!1),[a,o]=c.useState(!1),u=()=>{i(!0)},f=()=>{o(!0)};return t.jsxs("div",{className:"relative w-16 h-16 mx-auto",children:[t.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${n.avatar.gradient} rounded-full flex items-center justify-center ${n.avatar.textColor} font-bold text-xl transition-opacity duration-300 ${a&&!e?"opacity-0":"opacity-100"}`,children:n.initials}),!e&&t.jsx("img",{src:n.avatar.image,alt:`Photo de ${n.name}`,className:`absolute inset-0 w-full h-full object-cover rounded-full border-2 border-beige/20 transition-opacity duration-300 ${a?"opacity-100":"opacity-0"}`,onError:u,onLoad:f,loading:"lazy"}),a&&!e&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-dark-blue/10 rounded-full"})]})}function D({testimonial:n,isActive:e}){const a=(o=>{const u={green:"text-green-400 bg-green-400",blue:"text-blue-400 bg-blue-400",purple:"text-purple-400 bg-purple-400",orange:"text-orange-400 bg-orange-400"};return u[o]||u.green})(n.result.theme);return t.jsxs("div",{className:"bg-gradient-to-br from-beige/5 via-beige/3 to-transparent backdrop-blur-lg border border-beige/15 rounded-2xl hover:border-beige/25 hover:shadow-lg hover:shadow-black/10 transition-all duration-300 ease-out relative overflow-hidden group p-6 md:min-h-[400px] flex flex-col",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700 ease-out z-10 pointer-events-none"}),t.jsxs("div",{className:"relative z-20 flex flex-col h-full",children:[t.jsxs("div",{className:"text-center mb-6",children:[t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx($,{testimonial:n})}),t.jsxs("div",{className:"flex justify-center items-center gap-2",children:[t.jsx("div",{className:"flex text-yellow-400",children:[...Array(n.rating)].map((o,u)=>t.jsx("span",{children:"⭐"},u))}),t.jsxs("span",{className:"text-beige/60 text-sm",children:[n.rating,"/5"]})]})]}),t.jsxs("blockquote",{className:"text-beige/90 italic text-sm leading-relaxed flex-grow",children:['"',n.quote,'"']}),t.jsxs("div",{className:"border-t border-beige/10 pt-4 mt-6",children:[t.jsx("div",{className:"font-semibold text-copper text-lg",children:n.name}),t.jsx("div",{className:"text-sm text-beige/60 mb-3",children:n.company}),t.jsxs("div",{className:`text-sm mt-2 flex items-center justify-center gap-2 ${a.split(" ")[0]}`,children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${a.split(" ")[1]}`}),t.jsx("span",{children:n.result.text})]})]})]})]})}export{z as default};
