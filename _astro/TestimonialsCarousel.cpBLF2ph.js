import{j as e,c as N}from"../assets/useAnalytics-zD9jYb3S.js";import{r as n}from"../assets/index-CVf8TyFT.js";import{u as k,C as T}from"../assets/CarouselNavigation-DgZlH-gR.js";function S({testimonial:r}){const[t,c]=n.useState(!1),[o,d]=n.useState(!1),u=()=>{c(!0)},s=()=>{d(!0)};return e.jsxs("div",{className:"relative w-16 h-16 mx-auto",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${r.avatar.gradient} rounded-full flex items-center justify-center ${r.avatar.textColor} font-bold text-xl transition-opacity duration-300 ${o&&!t?"opacity-0":"opacity-100"}`,children:r.initials}),!t&&e.jsx("img",{src:r.avatar.image,alt:`Photo de ${r.name}`,className:`absolute inset-0 w-full h-full object-cover rounded-full border-2 border-beige/20 transition-opacity duration-300 ${o?"opacity-100":"opacity-0"}`,onError:u,onLoad:s,loading:"lazy"}),o&&!t&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-dark-blue/10 rounded-full"})]})}const q=n.memo(function({testimonial:t,isActive:c=!1,onClick:o}){const u=(s=>{const m={green:"text-green-400 bg-green-400",blue:"text-blue-400 bg-blue-400",purple:"text-purple-400 bg-purple-400",orange:"text-orange-400 bg-orange-400"};return m[s]||m.green})(t.result.theme);return e.jsxs("div",{className:`bg-gradient-to-br from-beige/5 via-beige/3 to-transparent 
        backdrop-blur-lg border border-beige/15 rounded-2xl
        relative overflow-hidden group p-6 md:min-h-[400px] flex flex-col
        transition-all duration-500 ease-out cursor-pointer
        min-h-[400px]
        ${c?"md:opacity-100 md:scale-105 md:shadow-2xl md:ring-2 md:ring-copper/20 md:hover:scale-110":"md:opacity-70 md:hover:opacity-90 md:hover:scale-102"}
        // Mobile : toutes les cartes ont la même apparence
        hover:border-beige/30 hover:shadow-xl hover:shadow-black/20
      `,onClick:o,role:"article",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),o?.())},children:[c&&e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent 
                      -translate-x-full group-hover:translate-x-full transition-transform 
                      duration-700 ease-out z-10 pointer-events-none`}),e.jsxs("div",{className:"relative z-20 flex flex-col h-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(S,{testimonial:t})}),e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("div",{className:"flex text-yellow-400",children:[...Array(t.rating)].map((s,m)=>e.jsx("span",{children:"⭐"},m))}),e.jsxs("span",{className:"text-beige/60 text-sm",children:[t.rating,"/5"]})]})]}),e.jsxs("blockquote",{className:"text-beige/90 italic text-sm leading-relaxed flex-grow",children:['"',t.quote,'"']}),e.jsxs("div",{className:"border-t border-beige/10 pt-4 mt-6",children:[e.jsx("div",{className:"font-semibold text-copper text-lg",children:t.name}),e.jsx("div",{className:"text-sm text-beige/60 mb-3",children:t.company}),e.jsxs("div",{className:`text-sm mt-2 flex items-center justify-center gap-2 ${u.split(" ")[0]}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${u.split(" ")[1]}`}),e.jsx("span",{children:t.result.text})]})]})]})]})},(r,t)=>r.testimonial===t.testimonial&&r.isActive===t.isActive),l=[{id:"pierre-m",name:"Pierre M.",initials:"PM",company:"Gérant, Comkwatt Communication",avatar:{gradient:"from-copper to-copper/80",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_pierre-m.webp"},rating:5,quote:"Grâce à la solution qu'il nous a mise en place, nous avons pu récupérer automatiquement les numéros de téléphone ou adresses email pour près de 85 % de la base — un gain de temps colossal par rapport à un traitement manuel qui aurait pris des mois.",result:{text:"Système : Enrichissement automatique des données",theme:"green"}},{id:"patrick-b",name:"Patrick B.",initials:"PB",company:"Directeur, Rietmann France",avatar:{gradient:"from-light-blue to-light-blue/80",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_patrick-b.webp"},rating:5,quote:"Chaque mois, nous passions plusieurs heures à remettre en forme des tableaux de tarifs. Grâce à l'automatisation mise en place par Thibaud (un simple glissé-déposé !), nous avons gagné un temps considérable et supprimé totalement le risque d'erreur.",result:{text:"Système : Analyse et réorganisation des tableaux de tarifs",theme:"blue"}},{id:"sarah-l",name:"Sarah L.",initials:"SL",company:"Directrice Commerciale, Orphise",avatar:{gradient:"from-copper to-light-blue",textColor:"text-dark-blue",image:"/assets/images/testimonials/quote_sarah-l.webp"},rating:5,quote:"Ce système nous a libérés d'une tâche lourde et répétitive. Chaque commercial gagne plusieurs heures par semaine et surtout : ils se concentrent enfin sur ce qu'ils font le mieux, convaincre nos prospects.",result:{text:"Système : Séquences de relance",theme:"purple"}}];function L(){const[r,t]=n.useState(!0),{trackInteraction:c,trackCardClick:o,isDebugPhase:d}=N("testimonials");n.useEffect(()=>{const a=setTimeout(()=>{r&&t(!1)},3e3);return()=>clearTimeout(a)},[r]);const{emblaRef:u,emblaApi:s,prevBtnDisabled:m,nextBtnDisabled:f,selectedIndex:p,scrollSnaps:h,scrollPrev:v,scrollNext:j,scrollTo:g}=k({options:{loop:!0,align:"center",slidesToScroll:1,containScroll:!1}}),x=n.useCallback(()=>(l.length,1),[]);n.useEffect(()=>{if(s){if(typeof window<"u"&&window.innerWidth>=768){const a=x();g(a,!0),setTimeout(()=>{let i=0;const C=l.length,b=()=>{i<C-1?(s.scrollNext(),i++,setTimeout(b,10)):setTimeout(()=>{s.scrollTo(x())},10)};b()},200)}t(!1)}else{const a=setTimeout(()=>{t(!1)},2e3);return()=>clearTimeout(a)}},[s,x,g]);const y=n.useCallback(a=>{if(d){console.log(`🎠 Testimonials: Still in debug phase, ignoring slide change to ${a}`);return}const i=Date.now()-(window.performance?.timing?.navigationStart||Date.now());if(i<400){console.log(`🎠 Testimonials: Too early (${i}ms), ignoring automatic slide change`);return}c(a,l[a]?.id,"swipe")},[c,d]),w=n.useCallback(a=>{s&&a!==p&&(s.scrollTo(a),d||(o(a,l[a]?.id),console.log(`🎠 Manual card click tracked: ${l[a]?.id}`)))},[s,p,o,d,l]);return n.useEffect(()=>{if(s)return console.log("🎠 TestimonialsCarousel: Auto-select tracking disabled"),()=>{}},[s,y]),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",id:"testimonials-skeleton",children:[...Array(3)].map((a,i)=>e.jsx("div",{className:"h-[400px] rounded-2xl bg-beige/10 animate-pulse"},i))}):l.length===0?e.jsx("div",{className:"text-center py-20 text-beige/60",children:"Aucun témoignage disponible"}):e.jsxs("div",{className:"relative carousel-wrapper",children:[e.jsx(T,{scrollSnaps:h,selectedIndex:p,scrollTo:g,scrollPrev:v,scrollNext:j,prevBtnDisabled:m,nextBtnDisabled:f,showArrows:!0}),e.jsx("div",{className:"embla",ref:u,style:{paddingTop:"20px",paddingBottom:"20px"},children:e.jsx("div",{className:"flex items-start embla__container",style:{gap:typeof window<"u"&&window.innerWidth>=768?"40px":"20px",paddingLeft:"16px",paddingRight:"16px"},children:l.map((a,i)=>e.jsx("div",{className:`flex-none embla__slide
                // Mobile : largeur complète moins paddings
                w-[calc(100vw-32px-20px)] 
                // Desktop : 30% comme spécifié
                md:w-[30%]
                // Largeur minimale pour lisibilité
                min-w-[280px]
              `,children:e.jsx(q,{testimonial:a,isActive:p===i,onClick:()=>w(i)})},a.id))})})]})}export{L as default};
